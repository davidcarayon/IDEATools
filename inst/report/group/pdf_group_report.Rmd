---
title: "Diagnostic IDEA4"
date: "Analyse du `r format(Sys.Date(), '%d %B %Y')`"
output:
  pdf_document:
    latex_engine: xelatex
    number_sections: yes
    toc: yes
    toc_depth: 3
header-includes:
- \usepackage[french]{babel}
- \usepackage{lastpage}
- \usepackage{float}
- \usepackage{graphicx}
- \usepackage{caption}
- \usepackage{tocloft}
- \renewcommand\cftsecfont{\Large}
- \renewcommand\cftsubsecfont{\large}
- \renewcommand\cftsubsubsecfont{\large}
- \renewcommand\cftsecpagefont{\Large}
- \captionsetup[figure]{font=large}
- \usepackage{fancyhdr}
- \pagestyle{fancy}
- \fancyfoot[C]{Diagnostic IDEA4 - `r format(Sys.Date(), "%d %B %Y")`}
- \fancyfoot[R]{Page \thepage / \pageref{LastPage}}
- \fancyhead[R]{}
- \fancyhead[C]{}
- \fancyhead[L]{}
- \renewcommand{\headrulewidth}{0pt}
mainfont: Ubuntu
subtitle: Eléments de sortie d'analyse de groupe - Version 2.0
params:
  outdir : "tmp"
  data: "data"
  dpi: 320
---

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, out.width = "100%", fig.pos = "H", 	dpi = params$dpi)
library(IDEATools)

outdir <- params$outdir
IDEAdata <- params$data

metadata <- IDEAdata$data$metadata
n_farm <- nrow(metadata)

write_idea(IDEAdata,output_directory = outdir,type = "local", dpi = params$dpi, quiet = TRUE)
```


```{r results = "asis"}
nb_files <- nrow(metadata)
cat(paste0("\\fancyfoot[L]{Nombre d'exploitations : ",nb_files,"}"))
```

\vspace{5mm}

```{r}
knitr::include_graphics("bandeau.png", auto_pdf = TRUE)
```

\newpage

# Lecture de la durabilité : approche par les trois dimensions de la durabilité

## Résultats collectifs globaux pour les trois dimensions

### Distribution des résultats du groupe

```{r fig.cap = "Distribution des notes obtenues pour chaque dimension de la durabilité", fig.width = 7.95, fig.height=6.91}
knitr::include_graphics(file.path(outdir,Sys.Date(),paste0("Groupe_",n_farm),"Graphiques","Distribution_dimensions.png"))
```

\newpage

## Résultats individuels globaux pour les trois dimensions

```{r fig.cap = "Visualisation des notes obtenues par chaque exploitation pour chaque dimension de la durabilité",fig.width = 10.5, fig.height=13}
knitr::include_graphics(file.path(outdir,Sys.Date(),paste0("Groupe_",n_farm),"Graphiques","Histogramme_dimensions.png"))
```

\newpage

## Résultats lus selon les 13 composantes

```{r fig.cap= "Distribution des notes de durabilité obtenues pour chaque composante", fig.width = 11.3, fig.height=8.94}
knitr::include_graphics(file.path(outdir,Sys.Date(),paste0("Groupe_",n_farm),"Graphiques","Distribution_composantes.png"))
```

\newpage

## Résultats détaillés par indicateur

### Indicateurs agroécologiques

```{r fig.cap= "Distribution des notes obtenues pour les indicateurs agroécologiques, regroupés par composante", fig.width = 11.9, fig.height=12.5}
knitr::include_graphics(file.path(outdir,Sys.Date(),paste0("Groupe_",n_farm),"Graphiques","Distribution_indicateurs_agroecologiques.png"))
```

### Indicateurs socio-territoriaux

```{r fig.cap= "Distribution des scores obtenus pour les indicateurs socio-territoriaux, regroupés par composante", fig.width = 11.9, fig.height=14}
knitr::include_graphics(file.path(outdir,Sys.Date(),paste0("Groupe_",n_farm),"Graphiques","Distribution_indicateurs_socio_territoriaux.png"))
```

### Indicateurs économiques

```{r fig.cap= "Distribution des scores obtenus pour les indicateurs économiques, regroupés par composante", fig.width = 11.9, fig.height=11}
knitr::include_graphics(file.path(outdir,Sys.Date(),paste0("Groupe_",n_farm),"Graphiques","Distribution_indicateurs_economiques.png"))
```

\newpage

# Lecture par les propriétés

## Matrice des résultats individuels

```{r fig.cap= "Matrice des résultats par les propriétés du groupe", fig.width = 10.4, fig.height=6.82}
knitr::include_graphics(file.path(outdir,Sys.Date(),paste0("Groupe_",n_farm),"Graphiques","Matrice_propriétés.png"))
```

## Fréquence d'attribution de chaque modalité

```{r fig.cap= "Fréquence d'attribution de chaque modalité pour chaque propriété", fig.width = 14 ,fig.height=5}
knitr::include_graphics(file.path(outdir,Sys.Date(),paste0("Groupe_",n_farm),"Graphiques","Fréquence_propriétés.png"))
```
